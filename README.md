# Mirae Asset AI Festival - 투자 분석 에이전트

## 프로젝트 개요

이 프로젝트는 네이버 종토방(토론방) 여론, 전문가 리서치 PDF, 실시간 주가 데이터를 통합 분석하여 투자 판단을 내리는 AI 기반 투자 분석 에이전트입니다.

## 핵심 특징

- **실시간 데이터 분석**: 매 실행 시마다 최신 데이터로 자동 크롤링 및 임베딩
- **자기 발전형 메모리**: 성공적 분석 패턴을 학습하여 점진적으로 개선되는 지능형 시스템
- **한국어 자연어 처리**: 한국어 질의 및 분석 결과 제공
- **LangChain ReAct 패턴**: 체계적인 사고-행동-관찰 반복 구조

## 전체 시스템 아키텍처

### 1. PDF 리서치 크롤러 (PDFResearchCrawler)
- 네이버 금융에서 특정 종목 관련 PDF 리서치 리포트 자동 크롤링
- 삼성전자, SK하이닉스, 카카오, 현대차 4개 종목 지원
- 최대 3개 PDF 파일 자동 다운로드 및 저장
- 파일명 자동 생성 및 중복 방지

### 2. 종토방 여론 분석 (NaverDiscussionRAGPipeline)
- 네이버 종목 토론방 실시간 댓글 크롤링
- 정치적/비속어 필터링 및 종목 관련성 검증
- 투자자 심리, 시장 관심도, 여론 분포 분석
- ChromaDB 기반 벡터 검색 및 요약

### 3. 전문가 리서치 분석 (ResearchRAGPipeline)
- PDF 폴더 내 리서치 리포트 자동 추출
- 투자의견, 목표주가 등 핵심 정보 기반 문서 정렬
- 전문가 의견, 실적 전망, 목표주가 분석
- 세그멘테이션 및 임베딩 후 ChromaDB 저장

### 4. 주가 데이터 분석 (StockPriceRAGPipeline)
- 실시간 및 최근 2개월 주가 데이터 수집
- 가격 변동, 추세, 주요 이슈 분석
- 기술적 지표 및 패턴 분석

### 5. 메모리 시스템 (AgentMemory)
- 분석 결과 자동 저장 및 품질 평가
- 최대 5개 분석, 상위 성과 2개 유지
- 유사 질문 recall, 최근/최고 성과 조회
- 성공 패턴 학습을 통한 도구 순서 최적화

### 6. 최종 분석 (FinalAnalysis)
- 모든 도구의 결과를 종합하여 최종 투자 판단
- 투자 판단: 매수/매도/유지 중 명확한 선택
- 근거 분석: 종토방, 리서치, 주가 데이터별 구체적 근거
- 위험 요소 및 기회 요소 분석
- 구체적인 투자 전략과 주의사항 제시

### 7. 메인 에이전트 (main_agent)
- ReAct 패턴 기반 순차적 분석 실행
- LLM 기반 도구 선택 및 실행
- 연속 실패 시 루프 강제 종료
- 최종 투자 판단 및 요약 제공

## 설치 및 설정

### 1. 환경 설정
```bash
pip install -r requirements.txt
```

### 2. 환경 변수 설정
`.env` 파일을 생성하고 다음 내용을 추가:
```
NCP_CLOVASTUDIO_API_KEY=your_api_key_here
```

### 3. 실행
```bash
python main_agent.py
```

## 사용 방법

### 질문 입력
프로그램 실행 후 자연어로 투자 관련 질문을 입력하세요.

**예시 질문:**
- 삼성전자에 지금 투자하는 것이 적절한가?
- 네이버 주식 투자 가치가 있는가?
- 카카오 매수 타이밍인가?
- 하이닉스 투자 전망은?

### 분석 과정
1. **데이터 최신화**: 기존 분석 데이터 삭제 (메모리 제외)
2. **PDF 크롤링**: 네이버 금융에서 리서치 리포트 자동 다운로드
3. **종토방 분석**: 실시간 투자자 여론 수집 및 분석
4. **리서치 분석**: 전문가 리포트 기반 분석
5. **주가 분석**: 최근 주가 데이터 및 기술적 분석
6. **최종 통합 판단**: 모든 데이터를 종합한 최종 투자 의견

### 결과 출력
- 각 단계별 분석 결과
- 최종 투자 판단 및 근거
- 메모리 시스템에 분석 결과 자동 저장

## 메모리 시스템 상세

### 품질 평가 기준
- **도구 사용 다양성** (최대 3점): 다양한 분석 도구 활용
- **관찰 결과 품질** (최대 2점): 상세한 분석 내용
- **최종 답변 품질** (최대 3점): 명확한 투자 의견 제시
- **분석 완성도** (최대 2점): 전체 분석 과정 완성

### 자기 발전 메커니즘
- 성공적인 분석 패턴 학습
- 도구별 성능 추적 및 최적화
- 회사별 인사이트 누적
- 유사 질문 시 과거 성공 패턴 활용

## 파일 구조

```
mirae_ai_festival/
├── main_agent.py                    # 메인 에이전트 (ReAct 패턴)
├── AgentMemory.py                   # 메모리 시스템 (자기 발전)
├── PDFResearchCrawler.py            # PDF 리서치 크롤러
├── NaverDiscussionRAGPipeline.py    # 종토방 여론 분석
├── ResearchRAGPipeline.py           # 전문가 리서치 분석
├── StockPriceRAGPipeline.py         # 주가 데이터 분석
├── FinalAnalysis.py                 # 최종 투자 판단
├── requirements.txt                 # 의존성 패키지
├── data/                            # 데이터 저장소
│   └── memory.json                 # 분석 메모리 (누적 저장)
├── pdf_downloads/                   # PDF 파일 저장소
└── chroma_langchain_db/             # 벡터 데이터베이스
```

## 기술 스택

- **LangChain**: AI 에이전트 프레임워크 (ReAct 패턴)
- **ChromaDB**: 벡터 데이터베이스 (임베딩 저장)
- **Clova X**: 한국어 LLM (분석 및 판단)
- **Selenium**: 웹 크롤링 (종토방 데이터)
- **BeautifulSoup**: HTML 파싱 (PDF 링크 추출)
- **PyMuPDF**: PDF 처리 (리서치 리포트)
- **Sentence Transformers**: 텍스트 임베딩 (벡터화)
- **Requests**: HTTP 요청 (PDF 다운로드)
- **Pandas**: 데이터 처리 (주가 데이터)

## 주의사항

- 실행 시마다 크롤링 데이터 및 ChromaDB가 최신으로 덮어쓰기됩니다
- 분석 메모리(memory.json)만 누적 저장됩니다
- API 키는 반드시 환경 변수로 설정하세요
- 네트워크 연결이 필요합니다
- PDF 크롤링은 최대 3회로 제한되어 있습니다
- 지원 종목: 삼성전자, SK하이닉스, 카카오, 현대차

## 라이선스

이 프로젝트는 미래에셋 AI 페스티벌을 위해 개발되었습니다. 
